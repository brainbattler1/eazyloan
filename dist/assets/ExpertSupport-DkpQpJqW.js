import{u as w,s as f,j as e}from"./index-DjnEXITF.js";import{r as i}from"./router-MjQpq3_0.js";import"./vendor-CSSWAZE4.js";import"./supabase-mDnqn92m.js";const I=({onClose:u})=>{const{user:d}=w(),[t,c]=i.useState("create"),[p,v]=i.useState([]),[l,o]=i.useState(!1),[N,h]=i.useState(!1),[a,n]=i.useState({subject:"",description:"",category:"general",priority:"medium"});i.useEffect(()=>{d&&t==="tickets"&&m()},[d,t]);const m=async()=>{try{o(!0);const{data:s,error:r}=await f.from("support_tickets").select("*").eq("user_id",d.id).order("created_at",{ascending:!1});if(r)throw r;v(s||[])}catch(s){console.error("Error fetching tickets:",s)}finally{o(!1)}},b=async s=>{if(s.preventDefault(),!a.subject.trim()||!a.description.trim()){alert("Please fill in all required fields");return}try{o(!0);const{data:r,error:x}=await f.rpc("create_support_ticket",{ticket_subject:a.subject.trim(),ticket_description:a.description.trim(),ticket_category:a.category,ticket_priority:a.priority});if(x)throw x;h(!0),setTimeout(()=>{h(!1)},5e3),n({subject:"",description:"",category:"general",priority:"medium"}),c("tickets")}catch(r){console.error("Error creating ticket:",r),alert("Error creating ticket: "+r.message)}finally{o(!1)}},y=s=>{switch(s){case"open":return"#3b82f6";case"in_progress":return"#f59e0b";case"waiting_customer":return"#8b5cf6";case"resolved":return"#10b981";case"closed":return"#6b7280";default:return"#6b7280"}},g=s=>{switch(s){case"open":return"üÜï";case"in_progress":return"üîÑ";case"waiting_customer":return"‚è≥";case"resolved":return"‚úÖ";case"closed":return"üîí";default:return"üìÑ"}},k=s=>{switch(s){case"urgent":return"#ef4444";case"high":return"#f59e0b";case"medium":return"#3b82f6";case"low":return"#10b981";default:return"#6b7280"}},q=s=>{switch(s){case"general":return"üí¨";case"loan_application":return"üìã";case"payments":return"üí≥";case"technical":return"üîß";case"account":return"üë§";case"complaint":return"‚ö†Ô∏è";default:return"üìÑ"}},j=s=>new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"dash-support-content",children:[e.jsxs("div",{className:"support-header",children:[e.jsx("h2",{children:"üìû Expert Support"}),u&&e.jsx("button",{className:"close-btn",onClick:u,children:"‚úï"})]}),N&&e.jsxs("div",{className:"success-message",children:[e.jsx("div",{className:"success-icon",children:"‚úÖ"}),e.jsxs("div",{className:"success-content",children:[e.jsx("h4",{children:"Ticket Submitted Successfully!"}),e.jsx("p",{children:"Contact support will assist within 24 hrs"})]}),e.jsx("button",{className:"close-success-btn",onClick:()=>h(!1),children:"‚úï"})]}),e.jsxs("div",{className:"support-tabs",children:[e.jsx("button",{className:`tab ${t==="create"?"active":""}`,onClick:()=>c("create"),children:"‚úâÔ∏è Create Ticket"}),e.jsx("button",{className:`tab ${t==="tickets"?"active":""}`,onClick:()=>c("tickets"),children:"üìã My Tickets"}),e.jsx("button",{className:`tab ${t==="faq"?"active":""}`,onClick:()=>c("faq"),children:"‚ùì FAQ"})]}),e.jsxs("div",{className:"tab-content",children:[t==="create"&&e.jsxs("div",{className:"create-ticket-tab",children:[e.jsxs("div",{className:"support-intro",children:[e.jsx("h3",{children:"üéØ Get Expert Help"}),e.jsx("p",{children:"Our financial experts are here to help you with any questions or concerns. We typically respond within 24 hours."})]}),e.jsxs("form",{onSubmit:b,className:"ticket-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Subject *"}),e.jsx("input",{type:"text",value:a.subject,onChange:s=>n({...a,subject:s.target.value}),placeholder:"Brief description of your issue",required:!0})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:a.category,onChange:s=>n({...a,category:s.target.value}),children:[e.jsx("option",{value:"general",children:"General Inquiry"}),e.jsx("option",{value:"loan_application",children:"Loan Application"}),e.jsx("option",{value:"payments",children:"Payments"}),e.jsx("option",{value:"technical",children:"Technical Issue"}),e.jsx("option",{value:"account",children:"Account Issue"}),e.jsx("option",{value:"complaint",children:"Complaint"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priority"}),e.jsxs("select",{value:a.priority,onChange:s=>n({...a,priority:s.target.value}),children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Description *"}),e.jsx("textarea",{value:a.description,onChange:s=>n({...a,description:s.target.value}),placeholder:"Please provide detailed information about your issue...",rows:6,required:!0})]}),e.jsx("button",{type:"submit",className:"submit-ticket-btn",disabled:l,children:l?"Submitting...":"Submit Ticket"})]})]}),t==="tickets"&&e.jsxs("div",{className:"tickets-tab",children:[e.jsxs("div",{className:"tickets-header",children:[e.jsx("h3",{children:"My Support Tickets"}),e.jsx("button",{className:"refresh-btn",onClick:m,disabled:l,children:"üîÑ Refresh"})]}),l?e.jsxs("div",{className:"loading-state",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading tickets..."})]}):p.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"üì≠"}),e.jsx("h4",{children:"No tickets yet"}),e.jsx("p",{children:"You haven't created any support tickets yet."}),e.jsx("button",{className:"card-btn",onClick:()=>c("create"),children:"Create Your First Ticket"})]}):e.jsx("div",{className:"tickets-list",children:p.map(s=>e.jsxs("div",{className:"ticket-card",children:[e.jsxs("div",{className:"ticket-header",children:[e.jsxs("div",{className:"ticket-info",children:[e.jsxs("div",{className:"ticket-subject",children:[q(s.category)," ",s.subject]}),e.jsxs("div",{className:"ticket-meta",children:[e.jsx("span",{className:"ticket-date",children:j(s.created_at)}),e.jsxs("span",{className:"ticket-id",children:["#",s.id]})]})]}),e.jsxs("div",{className:"ticket-status",children:[e.jsxs("span",{className:"status-badge",style:{backgroundColor:y(s.status)},children:[g(s.status)," ",s.status.replace("_"," ")]}),e.jsx("span",{className:"priority-badge",style:{backgroundColor:k(s.priority)},children:s.priority})]})]}),e.jsx("div",{className:"ticket-description",children:s.description}),s.admin_response&&e.jsxs("div",{className:"admin-response",children:[e.jsxs("div",{className:"response-header",children:[e.jsx("span",{className:"response-label",children:"Admin Response:"}),e.jsx("span",{className:"response-date",children:j(s.updated_at)})]}),e.jsx("div",{className:"response-content",children:s.admin_response})]})]},s.id))})]}),t==="faq"&&e.jsxs("div",{className:"faq-tab",children:[e.jsxs("div",{className:"faq-header",children:[e.jsx("h3",{children:"Frequently Asked Questions"}),e.jsx("p",{children:"Find quick answers to common questions"})]}),e.jsxs("div",{className:"faq-list",children:[e.jsxs("div",{className:"faq-item",children:[e.jsxs("div",{className:"faq-question",children:[e.jsx("span",{className:"faq-icon",children:"‚ùì"}),e.jsx("h4",{children:"How long does loan approval take?"})]}),e.jsx("div",{className:"faq-answer",children:e.jsx("p",{children:"Loan applications are typically reviewed within 24-48 hours. You'll receive an email notification once your application has been processed."})})]}),e.jsxs("div",{className:"faq-item",children:[e.jsxs("div",{className:"faq-question",children:[e.jsx("span",{className:"faq-icon",children:"‚ùì"}),e.jsx("h4",{children:"What documents do I need to apply?"})]}),e.jsx("div",{className:"faq-answer",children:e.jsx("p",{children:"You'll need a valid ID card, proof of income, and basic personal information. Additional documents may be requested based on your specific situation."})})]}),e.jsxs("div",{className:"faq-item",children:[e.jsxs("div",{className:"faq-question",children:[e.jsx("span",{className:"faq-icon",children:"‚ùì"}),e.jsx("h4",{children:"How do I make loan payments?"})]}),e.jsx("div",{className:"faq-answer",children:e.jsx("p",{children:"Payments can be made through M-Pesa, bank transfer, or at our physical locations. You'll receive payment instructions once your loan is approved."})})]}),e.jsxs("div",{className:"faq-item",children:[e.jsxs("div",{className:"faq-question",children:[e.jsx("span",{className:"faq-icon",children:"‚ùì"}),e.jsx("h4",{children:"What are the interest rates?"})]}),e.jsx("div",{className:"faq-answer",children:e.jsx("p",{children:"Interest rates vary based on loan amount, term, and your credit profile. Use our loan calculator to estimate your monthly payments."})})]}),e.jsxs("div",{className:"faq-item",children:[e.jsxs("div",{className:"faq-question",children:[e.jsx("span",{className:"faq-icon",children:"‚ùì"}),e.jsx("h4",{children:"Can I apply for multiple loans?"})]}),e.jsx("div",{className:"faq-answer",children:e.jsx("p",{children:"You can only have one active loan application at a time. Once your current application is processed, you can apply for additional loans if needed."})})]})]}),e.jsxs("div",{className:"support-info",children:[e.jsx("h4",{children:"Still need help?"}),e.jsx("p",{children:"If you couldn't find the answer you're looking for, our support team is here to help:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"üìß Email: support@boltfinance.com"}),e.jsxs("li",{children:["üìû Phone: ",e.jsx("a",{href:"tel:+254794105975",className:"support-link",children:"+254 794 105 975"})]}),e.jsxs("li",{children:["üí¨ WhatsApp: ",e.jsx("a",{href:"https://wa.me/18723298624",target:"_blank",rel:"noopener noreferrer",className:"support-link whatsapp-link",children:"+1 872 329 8624"})]}),e.jsx("li",{children:"‚è∞ Response Time: Within 24 hours"})]}),e.jsxs("div",{className:"support-actions",children:[e.jsx("a",{href:"https://wa.me/18723298624",target:"_blank",rel:"noopener noreferrer",className:"whatsapp-btn",children:"üí¨ Chat on WhatsApp"}),e.jsx("a",{href:"tel:+254794105975",className:"phone-btn",children:"üìû Call Support"})]})]})]})]})]})};export{I as default};
//# sourceMappingURL=ExpertSupport-DkpQpJqW.js.map
